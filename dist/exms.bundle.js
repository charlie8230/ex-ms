!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.EXMS=e():t.EXMS=e()}(this,function(){return function(t){function e(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=16)}([function(t,e,n){"use strict";function o(){d=!1}function r(t){if(!t)return void(f!==g&&(f=g,o()));if(t!==f){if(t.length!==g.length)throw new Error("Custom alphabet for shortid must be "+g.length+" unique characters. You submitted "+t.length+" characters: "+t);var e=t.split("").filter(function(t,e,n){return e!==n.lastIndexOf(t)});if(e.length)throw new Error("Custom alphabet for shortid must be "+g.length+" unique characters. These characters were not unique: "+e.join(", "));f=t,o()}}function i(t){return r(t),f}function s(t){h.seed(t),l!==t&&(o(),l=t)}function c(){f||r(g);for(var t,e=f.split(""),n=[],o=h.nextValue();e.length>0;)o=h.nextValue(),t=Math.floor(o*e.length),n.push(e.splice(t,1)[0]);return n.join("")}function u(){return d||(d=c())}function a(t){return u()[t]}var f,l,d,h=n(13),g="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-";t.exports={characters:i,seed:s,lookup:a,shuffled:u}},function(t,e,n){"use strict";function o(t){for(var e=window.location.search.substring(1),n=e.split("&"),o=0;o<n.length;o++){var r=n[o].split("=");if(r[0]==t)return r[1]}return!1}function r(t){return function(e){return t.bind(this,e)}}var i=n(7);t.exports={shortid:i,getQueryVariable:o,basic_curry:r}},function(t,e,n){"use strict";function o(t,e){for(var n,o=0,i="";!n;)i+=t(e>>4*o&15|r()),n=e<Math.pow(16,o+1),o++;return i}var r=n(12);t.exports=o},function(t,e,n){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=n(6).default,i=n(1),s=i.basic_curry,c=r(),u=Object.assign({onmessage:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if("function"==typeof t&&n.length>0){var r=s(t);n.forEach(function(t){var n=r(t);e.on(t,n)})}else if("object"===(void 0===t?"undefined":o(t)))for(var i in t)this.on(i,t[i])},broadcast:function(){this.emit.apply(this,arguments)},on:function(t,e){c.on(t,e)},off:function(t,e){c.off(t,e)}},c);t.exports={emitterAPI:u,emitter:c}},function(t,e,n){"use strict";var o=n(1),r=o.getQueryVariable,i=r("debug")||r("debugger"),s={log:function(){},error:function(){},warn:function(){}},c=i?console:s,u=c.log=i?console.log:s.log;t.exports={logger:c,log:u,debugMode:i}},function(t,e,n){"use strict";function o(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var r=n(1),i=n(17),s=new i({debugger:h,initCompleted:!1,moduleSelector:"[data-module]",maxServiceDepth:8}),c=n(15),u=n(3),a=(u.API,u.emitterAPI),f=n(4),l=f.logger,d=f.log,h=f.debugMode,g={globalConfig:s,get stacks(){return this.globalConfig.stack||{}},set stacks(t){this.globalConfig.stack=t},get config(){return this.globalConfig.config},set config(t){this.globalConfig.set(t)},init:function(t){this.globalConfig.set(t)},logger:l,getElements:function(){return document.querySelectorAll(this.config.moduleSelector)},addModule:function(t,e){s.addToStack("modules")(t,e)},addService:function(t,e){s.addToStack("services")(t,e)},addAction:function(t,e){s.addToStack("actions")(t,e)},addBehavior:function(t,e){s.addToStack("actions")(t,e)},getModuleName:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=e.replace(/[\[\]]/g,"");return t?t&&t.attributes&&t.attributes[n]&&t.attributes[n].value:t},getModule:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.stacks.modules;return e&&e.get(t)},startAll:function(){var t=this;this.stacks.moduleRefs.forEach(function(e){e.fn&&e.fn.init&&t.runFunction(e.fn,"init","Error running Init on "+e.name,!1)})},getService:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.stacks.services,n=e&&e.get(t),o=void 0;if(n){if("api"in n)return d("Got ",n.name," already"),n.api;var r=n.name,i=this.stacks.serviceInit;if(i.size>s.maxServiceDepth)return;if(i.has(r))return;return this.stacks={type:"serviceInit",name:r},o=this.runFunction(n,"fn","Error starting service: "+n.name,this),n.api=o,this.globalConfig.removeStackItem("serviceInit",r),o}},getGlobal:function(t){return void 0===window[t]?null:window[t]},getAction:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.stacks.actions;return e&&e.get(t)},runStart:function(){if(this.config.initCompleted)return!0;this.setupModules(),this.startAll()},startModules:function(t){var e=this;t?this.on(t,function(){e.runStart()}):this.runStart()},stop:function(t){var e=this,n=t.dataset._id&&t.dataset._id||String(t.id).replace(/module-/,"");if(void 0!==n||""!==n){var o=this.stacks.moduleRefs,r=this.stacks.actionRefs;if(r.has(n)){r.get(n).forEach(function(n){e.detachHandler(t,n.name,n.fn)}),this.globalConfig.removeStackItem("actionRefs",n)}if(!o.has(n))return;var i=o.get(n);i.destroy&&i.destroy(),this.globalConfig.removeStackItem("moduleRefs",n)}},reset:function(){this.globalConfig.reset()},cleanUpName:function(t){if(t.name){var e=String(t.name),n=e.replace(/^.*[\\\/]/,""),o=n.substr(0,n.lastIndexOf("."))||n;t.name=""+o}return t},processCache:function(){var t=this;if(this.cache&&this.cache.length>0){this.cache.map(this.cleanUpName).forEach(function(e){t.stacks=e}),this.cache=null}},_EVENT_TYPES:["click","mouseover","mouseout","mousedown","mouseup","mouseenter","mouseleave","mousemove","keydown","keyup","submit","change","contextmenu","dblclick","input","focusin","focusout"],attachHandler:function(t,e,n){t instanceof Node&&(t.dataset.hasEvents=!0,t.addEventListener(e,n))},detachHandler:function(t,e,n){t instanceof Node&&(t.dataset.hasEvents=!1,t.removeEventListener(e,n))},collectEvents:function(t,e,n){var o=this;Object.keys(e).filter(function(t){return o._EVENT_TYPES.lastIndexOf(t.replace(/^on/,""))>=0}).filter(function(t){return/on/.test(t)}).forEach(function(t){var r=e[t],i=t.replace(/^on/,"");o.attachHandler(n,i,r),o.stacks={type:"actionRefs",fn:r,name:i,id:n.dataset._id}})},runFunction:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"fn",n=arguments[2],r=void 0;if(e in t)try{for(var i=arguments.length,s=Array(i>3?i-3:0),c=3;c<i;c++)s[c-3]=arguments[c];r=t[e].apply(t,o(s))}catch(t){l.error(n,"\n",t)}return r},setupModules:function(){var t=this;this.processCache(),this.getElements().forEach(function(e){var n=t.getModuleName(e,t.config.moduleSelector);if(n){var o=t.getModule(n),i=new c(e,t,r);if(o&&o.fn){var s=void 0;if(s=t.runFunction(o,"fn","Error starting module "+n,i)){s.onmessage&&a.onmessage(s.onmessage,s.messages),t.collectEvents("module",s,i.el);var u=s.actions||s.behaviors||[];u&&u.length>0&&u.forEach(function(e){var n=t.getAction(e);if(n&&n.fn){var o=t.runFunction(n,"fn","Error starting behavior "+e,i);o&&t.collectEvents("behavior",o,i.el)}}),t.stacks={type:"moduleRefs",name:n,fn:s,id:i._id}}}}}),this.config={initCompleted:!0}}};Object.assign(g,a),t.exports=g},function(t,e,n){"use strict";function o(t){return t=t||Object.create(null),{on:function(e,n){(t[e]||(t[e]=[])).push(n)},off:function(e,n){t[e]&&t[e].splice(t[e].indexOf(n)>>>0,1)},emit:function(e,n){(t[e]||[]).map(function(t){t(n)}),(t["*"]||[]).map(function(t){t(e,n)})}}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=o},function(t,e,n){"use strict";t.exports=n(10)},function(t,e,n){"use strict";function o(t){var e="",n=Math.floor(.001*(Date.now()-u));return n===i?r++:(r=0,i=n),e+=s(c.lookup,a),e+=s(c.lookup,t),r>0&&(e+=s(c.lookup,r)),e+=s(c.lookup,n)}var r,i,s=n(2),c=n(0),u=1459707606518,a=6;t.exports=o},function(t,e,n){"use strict";function o(t){var e=r.shuffled();return{version:15&e.indexOf(t.substr(0,1)),worker:15&e.indexOf(t.substr(1,1))}}var r=n(0);t.exports=o},function(t,e,n){"use strict";function o(e){return c.seed(e),t.exports}function r(e){return l=e,t.exports}function i(t){return void 0!==t&&c.characters(t),c.shuffled()}function s(){return a(l)}var c=n(0),u=(n(2),n(9)),a=n(8),f=n(11),l=n(14)||0;t.exports=s,t.exports.generate=s,t.exports.seed=o,t.exports.worker=r,t.exports.characters=i,t.exports.decode=u,t.exports.isValid=f},function(t,e,n){"use strict";function o(t){if(!t||"string"!=typeof t||t.length<6)return!1;for(var e=r.characters(),n=t.length,o=0;o<n;o++)if(-1===e.indexOf(t[o]))return!1;return!0}var r=n(0);t.exports=o},function(t,e,n){"use strict";function o(){if(!i||!i.getRandomValues)return 48&Math.floor(256*Math.random());var t=new Uint8Array(1);return i.getRandomValues(t),48&t[0]}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i="object"===("undefined"==typeof window?"undefined":r(window))&&(window.crypto||window.msCrypto);t.exports=o},function(t,e,n){"use strict";function o(){return(i=(9301*i+49297)%233280)/233280}function r(t){i=t}var i=1;t.exports={nextValue:o,seed:r}},function(t,e,n){"use strict";t.exports=0},function(t,e,n){"use strict";function o(t,e,n){var o=t.id||"",r=n.shortid.generate(),i=o||r;this.el=this.elem=t,this._id=i,this.el.id="module-"+this._id,this.el.dataset._id=i,this.status="created",this.getService=e.getService.bind(e),this.getGlobal=e.getGlobal.bind(e)}var r=n(3),i=r.emitterAPI,s=n(4),c=s.logger;s.debugMode;o.prototype=Object.assign(o.prototype,i,{getElement:function(){return this.el},getConfig:function(){var t=this.el.children,e=null;try{[].forEach.call(t,function(t){e||"text/x-config"!=t.type||(e=JSON.parse(t.innerHTML))})}catch(t){c.log("Could not Parse config")}return e||{}},destroy:function(){this.el=null,this.status=null}}),t.exports=o},function(t,e,n){"use strict";var o=n(5),r=void 0,i=Object.assign(o,{noConflict:function(){return window.EXMS=r,this}});window.EXMS&&(r=window.EXMS),t.exports=i},function(t,e,n){"use strict";function o(){return Object.assign(a.stack,{services:new Map,serviceInit:new Set,modules:new Map,actions:new Map,moduleRefs:new Map,actionRefs:new Map,plugins:new Map})}function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(t)return Object.assign(a.config,t)}function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return a[t]||{}}function s(){function t(t){r(t)}function e(t,e,n,o){var r=a.stack;if("serviceInit"==t)r[t].add(e);else if("moduleRefs"==t)r[t].set(o,{type:t,name:e,fn:n});else if("actionRefs"==t){var i=r[t];if(i.has(o)){var s=i.get(o);s.push({type:t,name:e,fn:n})}else{var c=[{type:t,name:e,fn:n}];i.set(o,c)}}else t in r&&r[t].set(e,{type:t,name:e,fn:n})}function n(t){return u(e)(t)}function s(t,e){var n=a.stack;t in n&&n[t].delete(e)}function c(t){a.stack&&a.stack[t]&&a.stack[t].clear()}return t(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),{set:t,reset:o,addToStack:n,removeStackItem:s,clearStack:c,set config(t){this.set(t)},get config(){return i("config")},set stack(t){var n=t.type,o=t.name,r=t.fn,i=t.id;e(n,o,r,void 0===i?0:i)},get stack(){return a.stack}}}var c=n(1),u=c.basic_curry,a={config:{},stack:{}};o(),t.exports=s}])});